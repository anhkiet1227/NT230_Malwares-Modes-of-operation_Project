import os

MALWARE_FOLDER = "../data/malware_samples"
PERTURBED_FOLDER = "../data/perturbed_samples"

def apply_perturbation(file_path):
    # Implement perturbation code here
    # This could include adding or removing bytes, changing opcode sequences, etc.
    # For example, here we just append the byte 0x00 to the end of the file:
    with open(file_path, "ab") as f:
        f.write(b"\x00")

def main():
    if not os.path.exists(PERTURBED_FOLDER):
        os.makedirs(PERTURBED_FOLDER)

    # Loop through all malware samples
    for file_name in os.listdir(MALWARE_FOLDER):
        file_path = os.path.join(MALWARE_FOLDER, file_name)

        # Apply perturbation
        perturbed_file_path = os.path.join(PERTURBED_FOLDER, file_name)
        with open(file_path, "rb") as f_in, open(perturbed_file_path, "wb") as f_out:
            f_out.write(f_in.read())
            apply_perturbation(f_out)

if __name__ == "__main__":
    main()
